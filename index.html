<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NYM</title>
    <meta name="description"
        content="NYM App - Nostr Ynstant Messenger. Ephemeral anonymous messaging. Bridged with Bitchat geohash channels.">
    <link rel="manifest"
        href="data:application/json;base64,eyJuYW1lIjoiTllNIC0gTm9zdHIgWW5zdGFudCBNZXNzZW5nZXIiLCJzaG9ydF9uYW1lIjoiTllNIiwic3RhcnRfdXJsIjoiaHR0cHM6Ly9hcHAubnltLmJhciIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwidGhlbWVfY29sb3IiOiIjMDAwMDAwIiwiYmFja2dyb3VuZF9jb2xvciI6IiMwMDAwMDAiLCJpY29ucyI6W3sic3JjIjoiaHR0cHM6Ly9ueW0uYmFyL2ltYWdlcy9OWU0taWNvbi5wbmciLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2UvcG5nIn0seyJzcmMiOiJodHRwczovL255bS5iYXIvaW1hZ2VzL05ZTS1pY29uLnBuZyIsInNpemVzIjoiNTEyeDUxMiIsInR5cGUiOiJpbWFnZS9wbmcifV19Cg==">
    <link rel="icon" type="image/x-icon" href="https://nym.bar/images/favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="https://nym.bar/images/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="https://nym.bar/images/android-chrome-512x512.png">
    <link rel="apple-touch-icon" sizes="192x192" href="https://nym.bar/images/android-chrome-192x192.png">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Anonymously Chat with NYM">
    <meta property="og:description"
        content="Ephemeral anonymous messaging over Nostr. Bridged with Bitchat geohash channels.">
    <meta property="og:image" content="https://nym.bar/images/NYM-favicon.png">
    <meta property="og:url" content="https://app.nym.bar">
    <meta property="og:type" content="website">
    <link rel="icon" href="https://nym.bar/images/NYM-favicon.png" type="image/png">
    <link rel="canonical" href="https://app.nym.bar/">
    <meta name="theme-color" content="#000000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="NYM">
    <link rel="apple-touch-icon" href="https://nym.bar/images/NYM-favicon.png">

    <!-- Preload critical assets for faster paint -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="nostr-tools.js" as="script">
    <link rel="preload" href="app.js" as="script">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="mobile-overlay" id="mobileOverlay" onclick="nym.closeSidebar()"></div>
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">‚ò∞</button>

    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu">
        <div class="context-menu-item" id="ctxReact">React</div>
        <div class="context-menu-item" id="ctxMention">Mention</div>
        <div class="context-menu-item lightning" id="ctxZap" style="display: none;">‚ö° Zap</div>
        <div class="context-menu-item" id="ctxPM">Private Message</div>
        <div class="context-menu-item" id="ctxQuote">Quote Message</div>
        <div class="context-menu-item" id="ctxCopyPubkey">Copy Pubkey</div>
        <div class="context-menu-item report" id="ctxReport">Report</div>
        <div class="context-menu-item danger" id="ctxDeleteMessage">Delete Message</div>
        <div class="context-menu-item danger" id="ctxBlock">Block User</div>
    </div>

    <!-- Report Modal -->
    <div class="modal" id="reportModal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>Report User/Content</h2>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 15px; color: var(--text-dim);">
                    Reporting: <span id="reportTargetNym" style="color: var(--primary);"></span>
                </p>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; color: var(--text);">Report Type:</label>
                    <select id="reportType"
                        style="width: 100%; padding: 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px;">
                        <option value="nudity">Nudity - depictions of nudity, porn, etc.</option>
                        <option value="malware">Malware - virus, trojan, spyware, etc.</option>
                        <option value="profanity">Profanity - hateful speech, etc.</option>
                        <option value="illegal">Illegal - content that may be illegal</option>
                        <option value="spam">Spam</option>
                        <option value="impersonation">Impersonation - pretending to be someone else</option>
                        <option value="other">Other</option>
                    </select>
                </div>

                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; color: var(--text);">Additional Details
                        (optional):</label>
                    <textarea id="reportDetails" rows="4"
                        style="width: 100%; padding: 8px; background: var(--bg); border: 1px solid var(--border); color: var(--text); border-radius: 4px; resize: vertical;"
                        placeholder="Provide any additional context for this report..."></textarea>
                </div>

                <div style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; color: var(--text); cursor: pointer;">
                        <input type="checkbox" id="reportMessage" style="margin-right: 8px;">
                        Report specific message (if unchecked, reports the user profile)
                    </label>
                </div>

                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button onclick="nym.closeReportModal()"
                        style="padding: 10px 20px; background: var(--bg-secondary); border: 1px solid var(--border); color: var(--text); cursor: pointer; border-radius: 4px;">Cancel</button>
                    <button onclick="nym.submitReport()"
                        style="padding: 10px 20px; background: var(--warning); border: 1px solid var(--warning); color: #000; cursor: pointer; border-radius: 4px; font-weight: bold;">Submit
                        Report</button>

                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">NYM</div>
                <div class="tagline">Ephemeral Nostr Chat</div>
                <div class="nym-display" onclick="editNick()">
                    <div class="nym-label">Your Nym (click to edit)</div>
                    <div class="nym-value" id="currentNym">anonymous</div>
                </div>
                <div class="status-indicator">
                    <span class="status-dot" id="statusDot"></span>
                    <span id="connectionStatus">Disconnected</span>
                </div>
            </div>

            <div class="sidebar-actions">
                <button class="icon-btn" onclick="showChannelModal(); nym.closeSidebar();">+ Channel</button>
                <button class="icon-btn" onclick="nym.openShop(); nym.closeSidebar();">Shop</button>
                <button class="icon-btn" onclick="showSettings(); nym.closeSidebar();">Settings</button>
                <button class="icon-btn" onclick="showAbout(); nym.closeSidebar();">About</button>
                <button class="icon-btn" onclick="signOut(); nym.closeSidebar();" title="Logout">Logout</button>
            </div>

            <div class="nav-section">
                <div class="nav-title">
                    <span class="nav-title-text">Channels</span>
                    <span class="discover-icon" style="padding-right:30px;" onclick="nym.showGeohashExplorer()"
                        title="Explore geohash channels globally">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10" fill="none" stroke-width="2" />
                            <path
                                d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
                                fill="none" stroke-width="2" />
                        </svg>
                    </span>
                    <span class="search-icon" onclick="toggleSearch('channelSearch')">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </span>
                </div>
                <input type="text" class="search-input" id="channelSearch" placeholder="Search channels..."
                    oninput="this.value = this.value.toLowerCase(); nym.handleChannelSearch(this.value)"
                    onkeyup="nym.handleChannelSearch(this.value)">
                <div id="channelSearchResults"></div>
                <div class="channel-list" id="channelList">
                    <div class="channel-item active" data-channel="bar" data-geohash="">
                        <span class="channel-name">#bar</span>
                        <div class="channel-badges">
                            <span class="pin-btn" onclick="event.stopPropagation(); nym.togglePin('bar', '')">
                                <svg viewBox="0 0 24 24">
                                    <path d="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z" />
                                </svg>
                            </span>
                            <span class="std-badge">EPH</span>
                            <span class="unread-badge" style="display:none">0</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">
                    <span class="nav-title-text">Private Messages</span>
                    <span class="search-icon" onclick="toggleSearch('pmSearch')">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </span>
                </div>
                <input type="text" class="search-input" id="pmSearch" placeholder="Search PMs..."
                    onkeyup="nym.filterPMs(this.value)">
                <div class="pm-list" id="pmList"></div>
            </div>

            <div class="user-list" id="userList">
                <div class="nav-title">
                    <span class="nav-title-text">Active Nyms</span>
                    <span class="search-icon" onclick="toggleSearch('userSearch')">
                        <svg viewBox="0 0 24 24">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                    </span>
                </div>
                <input type="text" class="search-input" id="userSearch" placeholder="Search users..."
                    onkeyup="nym.filterUsers(this.value)">
                <div id="userListContent"></div>
            </div>
        </aside>

        <main class="main-content">
            <header class="chat-header">
                <div class="channel-info">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <div>
                            <div class="channel-title" id="currentChannel">#bar</div>
                            <div class="channel-meta" id="channelMeta">0 nyms in channel</div>
                        </div>
                        <button class="share-channel-btn" id="shareChannelBtn" onclick="nym.shareChannel()"
                            title="Share channel URL">
                            <svg viewBox="0 0 24 24" width="20" height="20">
                                <path
                                    d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z" />
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="icon-btn" onclick="showChannelModal()">+ Channel</button>
                    <button class="icon-btn" onclick="nym.openShop()">Shop</button>
                    <button class="icon-btn" onclick="showSettings()">Settings</button>
                    <button class="icon-btn" onclick="showAbout()">About</button>
                    <button class="icon-btn" onclick="signOut()" title="Logout">Logout</button>
                </div>
            </header>

            <div class="messages-container" id="messagesContainer">
                <div class="system-message">
                    ‚ïê‚ïê‚ïê Booting up NYM ‚ïê‚ïê‚ïê
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator"></div>

            <div class="input-container">
                <div class="input-wrapper">
                    <div class="autocomplete-dropdown" id="autocompleteDropdown"></div>
                    <div class="emoji-autocomplete" id="emojiAutocomplete"></div>
                    <div class="command-palette" id="commandPalette"></div>
                    <div class="upload-progress" id="uploadProgress">
                        <div>Uploading image...</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                    <textarea class="message-input" id="messageInput" placeholder="Type a message or / for commands..."
                        rows="1" disabled></textarea>
                </div>
                <div class="input-buttons">
                    <input type="file" class="file-input" id="fileInput" accept="image/*">
                    <button class="icon-btn input-btn" onclick="selectImage()" title="Upload Image">
                        <svg viewBox="0 0 24 24">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <circle cx="8.5" cy="8.5" r="1.5"></circle>
                            <polyline points="21 15 16 10 5 21"></polyline>
                        </svg>
                    </button>
                    <button class="icon-btn input-btn" onclick="nym.toggleEmojiPicker()" title="Emoji">
                        <svg viewBox="0 0 24 24">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M8 14s1.5 2 4 2 4-2 4-2"></path>
                            <circle cx="9" cy="9" r="1"></circle>
                            <circle cx="15" cy="9" r="1"></circle>
                        </svg>
                    </button>
                    <button class="icon-btn input-btn" onclick="nym.toggleGifPicker()" title="GIF">
                        <svg viewBox="0 0 24 24">
                            <text x="12" y="16" text-anchor="middle" font-size="12" fill="currentColor">GIF</text>
                        </svg>
                    </button>
                    <button class="send-btn" id="sendBtn" onclick="sendMessage()" disabled>SEND</button>
                </div>
                <div class="emoji-picker" id="emojiPicker"></div>
                <div class="gif-picker" id="gifPicker"></div>
            </div>
        </main>
    </div>

    <!-- Shop Modal -->
    <div class="shop-modal" id="shopModal">
        <div class="shop-content">
            <button class="shop-close" onclick="nym.closeShop()">‚úï</button>

            <div class="shop-header">
                <div class="shop-title">
                    <span>SHOP<br />
                        <span style="font-size:12px;">Buy addon packs to change the styling of your messages and
                            nickname that others will see across all channels.</span></span>
                </div>
                <div class="shop-recovery">
                    <input type="text" id="recoveryCodeInput" placeholder="Recovery code">
                    <button
                        onclick="nym.restorePurchases(document.getElementById('recoveryCodeInput').value)">Restore</button>
                </div>
            </div>

            <div class="shop-tabs">
                <button class="shop-tab active" onclick="nym.switchShopTab('styles', event)">Message Styles</button>
                <button class="shop-tab" onclick="nym.switchShopTab('flair', event)">Nickname Flair</button>
                <button class="shop-tab" onclick="nym.switchShopTab('special', event)">Special Items</button>
                <button class="shop-tab" onclick="nym.switchShopTab('inventory', event)">My Items</button>
            </div>

            <div class="shop-body" id="shopBody">
                <!-- Content will be dynamically generated -->
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div class="image-modal" id="imageModal" onclick="closeImageModal()">
        <span class="image-modal-close" onclick="closeImageModal()">√ó</span>
        <img id="modalImage" src="" alt="Expanded image">
    </div>

    <!-- Nick Edit Modal -->
    <div class="modal nick-edit-modal" id="nickEditModal">
        <div class="modal-content">
            <div class="modal-header">Change Your Nym's nickname</div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">New Nym nick</label>
                    <input type="text" class="form-input" id="newNickInput" placeholder="Enter new nym" maxlength="20">
                    <div class="form-hint">Your ephemeral pseudonym nickname for this session</div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="icon-btn" onclick="closeModal('nickEditModal')">Cancel</button>
                <button class="send-btn" onclick="changeNick()">Change</button>
            </div>
        </div>
    </div>

    <!-- Initial Setup Modal -->
    <div class="modal active" id="setupModal">
        <div class="modal-content">
            <div class="modal-header">Welcome to NYM<br /><label style="color: var(--warning); margin-top:5px;"
                    class="form-label">Ephemeral, anonymous, decentralized chat</label></div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Connection Mode</label>
                    <select class="form-select" id="connectionMode">
                        <option value="ephemeral">Ephemeral (Auto-generate temporary keys)</option>
                        <option value="create">Create New Account (Persistent Nostr identity)</option>
                        <option value="extension">Use Nostr Extension (Existing Persistent identity)</option>
                        <option value="nsec">Use NSEC Private Key (Existing Persistent identity)</option>
                        <option value="bunker">Nostr Connect / Bunker (Remote signing)</option>
                    </select>
                </div>

                <!-- Account Creation Multi-Step Flow -->
                <div id="accountCreationSteps" class="account-creation-steps">
                    <!-- Step Indicators -->
                    <div class="step-indicators">
                        <div class="step-indicator active" id="indicator-0"></div>
                        <div class="step-indicator" id="indicator-1"></div>
                        <div class="step-indicator" id="indicator-2"></div>
                        <div class="step-indicator" id="indicator-3"></div>
                    </div>

                    <!-- Step 0: Introduction to Nostr -->
                    <div class="step" id="step-0" style="display: block;">
                        <div class="step-header">What is Nostr?</div>
                        <div class="step-content">
                            <p><strong>Nostr</strong> (Notes and Other Stuff Transmitted by Relays) is a simple, open
                                protocol for creating censorship-resistant social networks.</p>

                            <ul class="info-list">
                                <li><strong>Decentralized:</strong> No single company controls your data</li>
                                <li><strong>Portable Identity:</strong> Your account works across all Nostr apps</li>
                                <li><strong>Censorship Resistant:</strong> No one can ban or silence you</li>
                                <li><strong>Cryptographically Secure:</strong> Your identity is backed by public key
                                    cryptography</li>
                            </ul>

                            <p>When you create a Nostr account, you're generating a cryptographic key pair that becomes
                                your unique, portable identity across the entire Nostr network.</p>
                        </div>
                        <div class="step-actions">
                            <button class="send-btn" onclick="nextAccountCreationStep()">Next: Generate Keys</button>
                        </div>
                    </div>

                    <!-- Step 1: Key Generation -->
                    <div class="step" id="step-1">
                        <div class="step-header">Generate Your Keys</div>
                        <div class="step-content">
                            <p>Your Nostr identity consists of two keys:</p>

                            <ul class="info-list">
                                <li><strong>Public Key (npub):</strong> Like your username - share this with others</li>
                                <li><strong>Private Key (nsec):</strong> Like your password - NEVER share this with
                                    anyone!</li>
                            </ul>

                            <p>Click the button below to generate your unique key pair. This happens entirely in your
                                browser - we never see or store your keys on any server.</p>

                            <button class="send-btn" onclick="generateAndDisplayKeys(); nextAccountCreationStep();"
                                style="width: 100%; margin-top: 15px;">
                                Generate My Keys
                            </button>
                        </div>
                        <div class="step-actions">
                            <button class="send-btn" style="background-color: var(--bg-tertiary);"
                                onclick="previousAccountCreationStep()">Back</button>
                        </div>
                    </div>

                    <!-- Step 2: Display Keys with Security Warning -->
                    <div class="step" id="step-2">
                        <div class="step-header">Save Your Private Key</div>

                        <div class="warning-box">
                            <strong>‚ö†Ô∏è CRITICAL: Save Your Private Key Now!</strong>
                            <p>Your private key is the ONLY way to access your account. If you lose it, your account is
                                gone forever. We cannot recover it for you.</p>
                        </div>

                        <div class="step-content">
                            <label
                                style="color: var(--secondary); font-weight: bold; display: block; margin-bottom: 5px;">Your
                                Private Key (nsec)</label>
                            <div class="key-display" id="generated-nsec">Generating...</div>
                            <button class="copy-btn" onclick="copyNsecToClipboard()">üìã Copy Private Key</button>

                            <div style="margin-top: 20px;">
                                <label
                                    style="color: var(--text-dim); font-weight: bold; display: block; margin-bottom: 5px;">Your
                                    Public Key (npub)</label>
                                <div class="key-display" id="generated-npub">Generating...</div>
                            </div>

                            <div
                                style="margin-top: 20px; padding: 15px; background-color: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-dim);">
                                <p style="color: var(--text-dim); font-size: 13px; margin: 0;">
                                    <strong>How to store your private key:</strong><br />
                                    ‚Ä¢ Write it down on paper and store it safely<br />
                                    ‚Ä¢ Use a password manager (recommended)<br />
                                    ‚Ä¢ Store it in an encrypted file<br />
                                    ‚Ä¢ NEVER share it or post it online<br />
                                    ‚Ä¢ NEVER enter it on websites you don't trust
                                </p>
                            </div>

                            <label style="display: flex; align-items: center; margin-top: 20px; cursor: pointer;">
                                <input type="checkbox" id="keySavedCheckbox" style="margin-right: 10px;">
                                <span style="color: var(--text-primary); font-size: 14px;">I have securely saved my
                                    private key</span>
                            </label>
                        </div>

                        <div class="step-actions">
                            <button class="send-btn" style="background-color: var(--bg-tertiary);"
                                onclick="previousAccountCreationStep()">Back</button>
                            <button class="send-btn"
                                onclick="if(document.getElementById('keySavedCheckbox').checked) { nextAccountCreationStep(); } else { alert('Please confirm that you have saved your private key'); }">Next:
                                Choose Nickname</button>
                        </div>
                    </div>

                    <!-- Step 3: Choose Nickname -->
                    <div class="step" id="step-3">
                        <div class="step-header">Choose Your Nickname</div>
                        <div class="step-content">
                            <p>Pick a nickname (nym) for your account. This will be stored in your Nostr profile (kind 0
                                metadata event) and will be visible to others in the network.</p>

                            <div class="form-group" style="margin-top: 20px;">
                                <label class="form-label">Your Nickname</label>
                                <input type="text" class="form-input" id="newAccountNym"
                                    placeholder="Enter your nickname" maxlength="20">
                                <div class="form-hint">This will be your display name on Nostr</div>
                            </div>

                            <div
                                style="margin-top: 20px; padding: 15px; background-color: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-dim);">
                                <p style="color: var(--text-dim); font-size: 13px; margin: 0;">
                                    Your nickname will be published as a <strong>kind 0 metadata event</strong> to the
                                    Nostr network. You can change it later in settings.
                                </p>
                            </div>
                        </div>

                        <div class="step-actions">
                            <button class="send-btn" style="background-color: var(--bg-tertiary);"
                                onclick="previousAccountCreationStep()">Back</button>
                            <button class="send-btn" onclick="finalizeAccountCreation()">Create Account & Enter
                                NYM</button>
                        </div>
                    </div>
                </div>

                <!-- NSEC -->
                <div class="form-group" id="nsecGroup" style="display:none">
                    <label class="form-label">Enter your NSEC</label>
                    <input type="password" class="form-input" id="nsecInput" placeholder="nsec1...">
                    <div class="form-hint">Your private key will be stored locally</div>
                </div>

                <!-- Nostr Connect / Bunker -->
                <div class="form-group" id="bunkerGroup" style="display:none">
                    <label class="form-label">Connect with Nostr Bunker</label>

                    <div style="margin-bottom: 15px;">
                        <button class="copy-btn" onclick="showBunkerPairing()" style="width: 100%;">
                            Pair with Mobile App (Amber, etc.)
                        </button>
                    </div>

                    <div id="bunkerPairingSection" style="display:none; margin-bottom: 20px;">
                        <div class="step-header" style="font-size: 16px; margin-bottom: 10px;">Scan with your bunker app
                        </div>
                        <div id="bunkerQRCode"
                            style="background: white; padding: 20px; border-radius: 8px; display: flex; justify-content: center; align-items: center; min-height: 200px;">
                            <div style="color: #333;">Generating QR code...</div>
                        </div>
                        <div style="margin-top: 10px; padding: 10px; background-color: var(--bg-secondary); border-radius: 6px; font-family: monospace; font-size: 11px; word-break: break-all; max-height: 80px; overflow-y: auto; cursor: pointer;"
                            id="bunkerUriDisplay" onclick="copyBunkerUri()"></div>
                        <div class="form-hint">Open Amber or another NIP-46 compatible app and scan this QR code</div>
                        <div id="bunkerWaitingStatus"
                            style="margin-top: 15px; color: var(--warning); text-align: center; display: none;">
                            <div class="spinner"
                                style="display: inline-block; width: 16px; height: 16px; border: 2px solid var(--warning); border-top-color: transparent; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 8px;">
                            </div>
                            Waiting for approval...
                        </div>
                    </div>

                    <div style="text-align: center; margin: 15px 0; color: var(--text-dim);">‚Äî OR ‚Äî</div>

                    <label class="form-label">Enter Bunker URI</label>
                    <input type="text" class="form-input" id="bunkerInput"
                        placeholder="bunker://pubkey?relay=wss://...">
                    <div class="form-hint">Paste your bunker:// connection string from nsec.app or another signer</div>
                </div>

                <div class="form-group" id="nymGroup">
                    <label class="form-label">Choose Your Nym's nickname (optional)</label>
                    <input type="text" class="form-input" id="nymInput" placeholder="Leave empty for random nick"
                        maxlength="20">
                    <div class="form-hint" id="nymHint">Your ephemeral pseudonym nickname for this session</div>

                    <div id="autoEphemeralGroup" style="margin-top: 15px;">
                        <label style="display: flex; align-items: center; cursor: pointer; font-size: 14px;">
                            <input type="checkbox" id="autoEphemeralCheckbox"
                                style="margin-right: 10px; width: auto; cursor: pointer;">
                            <span style="color: var(--text-dim);">Automatically assign new ephemeral nym on each session
                                restart to skip the welcome screen</span>
                        </label>
                    </div>
                </div>

                <div
                    style="color: var(--warning); font-size: 12px; margin-top: 15px; padding: 10px; border: 1px solid var(--warning);">
                    NOTE: Channels are bridged with Bitchat geohash. Messages are
                    public and temporary; sent across the Nostr network. Your nym exists
                    only for this session and will be burned.
                </div>
            </div>
            <div class="modal-actions" style="margin-bottom:20px;">
                <button class="send-btn" id="enterNymBtn" onclick="initializeNym()">Enter NYM</button>
            </div>
            <span style="color: var(--text-dim);">By entering, you agree to our <a
                    href="https://github.com/Spl0itable/NYM/blob/main/TOS.md" target="_blank" rel="noopener"
                    style="color: var(--secondary)">Terms of Service</a> and <a
                    href="https://github.com/Spl0itable/NYM/blob/main/PP.md" target="_blank" rel="noopener"
                    style="color: var(--secondary)">Privacy Policy</a>.</span>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">Settings</div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Connected Relays</label>
                    <div id="connectedRelaysList"
                        style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; background: var(--bg);">
                        <div style="color: var(--text-dim); font-size: 12px;">Loading relay list...</div>
                    </div>
                    <button class="icon-btn" onclick="nym.refreshRelays()"
                        style="margin-top: 10px; width: 100%;">Refresh Relay List</button>
                </div>

                <div class="form-group">
                    <label class="form-label">Sort Geohash Channels by Proximity</label>
                    <select class="form-select" id="proximitySelect">
                        <option value="false">Disabled</option>
                        <option value="true">Enabled (requires location access)</option>
                    </select>
                    <div class="form-hint">Sort geohash channels by distance from your location</div>
                </div>

                <div class="form-group">
                    <label class="form-label">‚ö° Lightning Address</label>
                    <input type="text" class="form-input" id="lightningAddressInput"
                        placeholder="your@lightning-address.com">
                    <div class="form-hint">Your Lightning address for receiving zaps</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Theme</label>
                    <select class="form-select" id="themeSelect">
                        <option value="bitchat">Bitchat (Multicolor)</option>
                        <option value="matrix">Matrix Green</option>
                        <option value="amber">Amber Terminal</option>
                        <option value="cyber">Cyberpunk</option>
                        <option value="hacker">Hacker Blue</option>
                        <option value="ghost">Ghost (B&W)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Proof of Work Difficulty:</label>
                    <select class="form-select" id="powDifficultySelect">
                        <option value="0" selected>Disabled</option>
                        <option value="8">Very Low (8 bits)</option>
                        <option value="12">Low (12 bits)</option>
                        <option value="16">Medium (16 bits)</option>
                        <option value="20">High (20 bits)</option>
                        <option value="24">Very High (24 bits)</option>
                    </select>
                    <div class="form-hint">Enable for anti-spam to require messages have a minimum PoW</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Disappearing PM (forward secrecy)</label>
                    <select class="form-select" id="dmForwardSecrecySelect">
                        <option value="false">Disabled</option>
                        <option value="true">Enabled</option>
                    </select>
                    <div class="form-hint">
                        When enabled, your private messages include an "expiration" tag (NIP‚Äë40) so relays/clients can
                        delete them after the period chosen when enabled.
                    </div>
                </div>

                <div class="form-group" id="dmTTLGroup">
                    <label class="form-label">Disappear After</label>
                    <select class="form-select" id="dmTTLSelect">
                        <option value="3600">1 hour</option>
                        <option value="21600">6 hours</option>
                        <option value="86400" selected>1 day</option>
                        <option value="259200">3 days</option>
                        <option value="604800">7 days</option>
                    </select>
                    <div class="form-hint">This sets the "expiration" timestamp on each outgoing gift‚Äëwrapped PM.</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Read Receipts</label>
                    <select class="form-select" id="readReceiptsSelect">
                        <option value="true">Enabled</option>
                        <option value="false">Disabled</option>
                    </select>
                    <div class="form-hint">When enabled, senders will see when you've read their private messages (‚úì‚úì).</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Notification Sound</label>
                    <select class="form-select" id="soundSelect">
                        <option value="beep">Classic Beep</option>
                        <option value="icq">ICQ Uh-Oh</option>
                        <option value="msn">MSN Alert</option>
                        <option value="none">Silent</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Auto-scroll Messages</label>
                    <select class="form-select" id="autoscrollSelect">
                        <option value="true">Enabled</option>
                        <option value="false">Disabled</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Show Timestamps</label>
                    <select class="form-select" id="timestampSelect">
                        <option value="true">Show</option>
                        <option value="false">Hide</option>
                    </select>
                </div>

                <div class="form-group" id="timeFormatGroup">
                    <label class="form-label">Time Format</label>
                    <select class="form-select" id="timeFormatSelect">
                        <option value="24hr" selected>24-hour (14:30)</option>
                        <option value="12hr">12-hour (2:30 PM)</option>
                    </select>
                </div>

                <div class="form-group" id="autoEphemeralSettingGroup" style="display: none;">
                    <label class="form-label">Auto Ephemeral Mode on Restart</label>
                    <select class="form-select" id="autoEphemeralSelect">
                        <option value="false">Disabled</option>
                        <option value="true">Enabled (auto sign-in)</option>
                    </select>
                    <div class="form-hint">Automatically sign in with ephemeral mode on app restart</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Pinned Landing Channel</label>
                    <div style="position: relative;">
                        <input type="text" class="form-control" id="pinnedLandingChannelSearch"
                            placeholder="Type to search or select a channel..." autocomplete="off"
                            style="padding: 8px 12px; border: 1px solid var(--border); background: var(--background-alt); color: var(--text); border-radius: 4px; font-size: 14px; width: 100%;" />
                        <input type="hidden" id="pinnedLandingChannelValue" />
                        <div id="pinnedLandingChannelDropdown"
                            style="display: none; position: absolute; top: 100%; left: 0; right: 0; max-height: 300px; overflow-y: auto; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 4px; margin-top: 4px; z-index: 1000; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        </div>
                    </div>
                    <div class="form-hint">Channel to load when you first open or reload the app</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Blur Images from Others</label>
                    <select class="form-select" id="blurImagesSelect">
                        <option value="true">Enabled (blur by default)</option>
                        <option value="false">Disabled (show all images)</option>
                    </select>
                    <div class="form-hint">Blur images shared by others until clicked. Your own images are never
                        blurred.</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Blocked Keywords/Phrases</label>
                    <input type="text" class="form-input" id="newKeywordInput"
                        placeholder="Add keyword or phrase to block">
                    <button class="icon-btn" onclick="nym.addBlockedKeyword()"
                        style="margin-top: 10px; width: 100%;">Add Keyword</button>
                    <div class="keyword-list" id="keywordList" style="margin-top: 10px;">
                        <div style="color: var(--text-dim); font-size: 12px;">No blocked keywords</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Blocked Channels</label>
                    <div class="blocked-list" id="blockedChannelsList">
                        <div style="color: var(--text-dim); font-size: 12px;">No blocked channels</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Blocked Users</label>
                    <div class="blocked-list" id="blockedList">
                        <div style="color: var(--text-dim); font-size: 12px;">No blocked users</div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="icon-btn" onclick="closeModal('settingsModal')">Cancel</button>
                <button class="send-btn" onclick="saveSettings()">Save</button>
            </div>
        </div>
    </div>

    <!-- Channel Modal -->
    <div class="modal" id="channelModal">
        <div class="modal-content">
            <div class="modal-header">Join/Create Channel</div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Channel Type</label>
                    <select class="form-select" id="channelTypeSelect">
                        <option value="standard">Standard Channel (Ephemeral)</option>
                        <option value="geohash">Location-based (Geohash)</option>
                        <option value="community">Community Channel (Requires Login)</option>
                    </select>
                </div>

                <div class="form-group" id="standardChannelGroup">
                    <label class="form-label">Channel Name</label>
                    <input type="text" class="form-input" id="channelNameInput" placeholder="random"
                        oninput="this.value = this.value.toLowerCase().replace(/[^a-z0-9-]/g, '')">
                    <div class="form-hint">Enter channel name without # (e.g., "random" for #random). No spaces allowed
                        - use hyphens.</div>
                </div>

                <div class="form-group" id="geohashGroup" style="display:none">
                    <label class="form-label">Geohash</label>
                    <input type="text" class="form-input" id="geohashInput" placeholder="e.g., w1, dr5r, etc."
                        maxlength="12"
                        oninput="this.value = this.value.toLowerCase().replace(/[^0-9bcdefghjkmnpqrstuvwxyz]/g, '')">
                    <div class="form-hint">Enter a geohash code (valid chars: 0-9, b-z except a,i,l,o)</div>
                </div>

                <div id="communityChannelGroup" style="display:none">
                    <div class="form-group">
                        <label class="form-label">Community Name</label>
                        <input type="text" class="form-input" id="communityNameInput" placeholder="bitcoin"
                            oninput="this.value = this.value.toLowerCase().replace(/[^a-z0-9-]/g, '')">
                        <div class="form-hint">A unique name for your community. No spaces allowed - use hyphens.</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Description</label>
                        <textarea class="form-textarea" id="communityDescInput"
                            placeholder="Describe your community (optional)"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Community Image URL (optional)</label>
                        <input type="text" class="form-input" id="communityImageInput"
                            placeholder="https://example.com/image.png">
                        <div class="form-hint">URL to an image representing your community</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Privacy</label>
                        <select class="form-select" id="communityPrivacySelect">
                            <option value="public">Public (anyone can join)</option>
                            <option value="private">Private (invite only)</option>
                        </select>
                    </div>

                    <div
                        style="color: var(--warning); font-size: 11px; margin-top: 10px; padding: 8px; border: 1px solid var(--warning);">
                        NOTE: Community channels are persistent and tied to your Nostr identity. You will be the admin.
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="icon-btn" onclick="closeModal('channelModal')">Cancel</button>
                <button class="send-btn" onclick="joinOrCreateChannel()">Join/Create</button>
            </div>
        </div>
    </div>

    <!-- Community Settings Modal -->
    <div class="modal" id="communitySettingsModal">
        <div class="modal-content">
            <div class="modal-header">Community Settings</div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Community Name</label>
                    <div id="communityNameDisplay" style="font-size: 16px; color: var(--primary); padding: 8px 0;">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Community Image</label>
                    <div id="communityImagePreview" style="margin-bottom: 10px; display: none;">
                        <img id="communityImagePreviewImg" src="" alt="Community image"
                            style="max-width: 200px; max-height: 200px; border: 1px solid var(--border);">
                    </div>
                    <input type="text" class="form-input" id="communityImageEdit"
                        placeholder="https://example.com/image.png">
                    <div class="form-hint">URL to an image representing your community</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="communityDescEdit"
                        placeholder="Community description"></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">Privacy</label>
                    <select class="form-select" id="communityPrivacyEdit">
                        <option value="public">Public (anyone can join)</option>
                        <option value="private">Private (invite only)</option>
                    </select>
                    <div class="form-hint">Changing privacy will take effect immediately</div>
                </div>

                <div class="form-group">
                    <label class="form-label">Blocked Keywords/Phrases</label>
                    <input type="text" class="form-input" id="newCommunityKeywordInput"
                        placeholder="Add keyword or phrase to block">
                    <button class="icon-btn" onclick="nym.addCommunityKeyword()"
                        style="margin-top: 10px; width: 100%;">Add Keyword</button>
                    <div class="keyword-list" id="communityKeywordList"
                        style="margin-top: 10px; max-height: 150px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; background: var(--bg);">
                        <div style="color: var(--text-dim); font-size: 12px;">No blocked keywords</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Moderators</label>
                    <div id="communityModsList"
                        style="max-height: 150px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; background: var(--bg);">
                        <div style="color: var(--text-dim); font-size: 12px;">Loading moderators...</div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <input type="text" class="form-input" id="addModInput" placeholder="Enter nym or nym#xxxx"
                            style="flex: 1;">
                        <button class="icon-btn" onclick="nym.addModFromSettings()">Add Mod</button>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Banned Users</label>
                    <div id="communityBansList"
                        style="max-height: 150px; overflow-y: auto; border: 1px solid var(--border); padding: 10px; background: var(--bg);">
                        <div style="color: var(--text-dim); font-size: 12px;">No banned users</div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Statistics</label>
                    <div
                        style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 10px; background: var(--bg-tertiary); border: 1px solid var(--border);">
                        <div style="text-align: center;">
                            <div style="font-size: 20px; color: var(--primary);" id="statMembers">0</div>
                            <div style="font-size: 11px; color: var(--text-dim);">Members</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 20px; color: var(--secondary);" id="statMods">0</div>
                            <div style="font-size: 11px; color: var(--text-dim);">Moderators</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 20px; color: var(--danger);" id="statBanned">0</div>
                            <div style="font-size: 11px; color: var(--text-dim);">Banned</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" style="color: var(--danger);">Danger Zone</label>
                    <button class="icon-btn" onclick="nym.deleteCommunity()"
                        style="width: 100%; background: var(--bg); border-color: var(--danger); color: var(--danger);">
                        Delete Community
                    </button>
                    <div class="form-hint" style="color: var(--danger);">This action cannot be undone</div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="icon-btn" onclick="closeModal('communitySettingsModal')">Close</button>
                <button class="send-btn" onclick="nym.saveCommunitySettings()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Zap Modal -->
    <div class="modal zap-modal" id="zapModal">
        <div class="modal-content">
            <div class="modal-header">‚ö° Send Lightning Zap</div>
            <div class="modal-body">
                <div id="zapRecipientInfo" style="text-align: center; margin-bottom: 20px; color: var(--text-dim);">
                </div>

                <div id="zapAmountSection">
                    <div class="form-group">
                        <label class="form-label">Select Amount</label>
                        <div class="zap-amounts">
                            <button class="zap-amount-btn" data-amount="21">
                                <span class="sats">21</span>
                                sats
                            </button>
                            <button class="zap-amount-btn" data-amount="100">
                                <span class="sats">100</span>
                                sats
                            </button>
                            <button class="zap-amount-btn" data-amount="500">
                                <span class="sats">500</span>
                                sats
                            </button>
                            <button class="zap-amount-btn" data-amount="1000">
                                <span class="sats">1K</span>
                                sats
                            </button>
                            <button class="zap-amount-btn" data-amount="5000">
                                <span class="sats">5K</span>
                                sats
                            </button>
                            <button class="zap-amount-btn" data-amount="10000">
                                <span class="sats">10K</span>
                                sats
                            </button>
                        </div>
                    </div>

                    <div class="form-group zap-custom-amount">
                        <input type="number" class="form-input" id="zapCustomAmount" placeholder="Custom amount (sats)"
                            min="1">
                    </div>

                    <div class="form-group zap-comment">
                        <label class="form-label">Comment (optional)</label>
                        <input type="text" class="form-input" id="zapComment" placeholder="Add a comment to your zap">
                    </div>
                </div>

                <div id="zapInvoiceSection" style="display: none;">
                    <div class="zap-status checking" id="zapStatus">
                        <span class="loader"></span> Generating invoice...
                    </div>

                    <div id="zapInvoiceDisplay" style="display: none;">
                        <div class="zap-invoice-qr" id="zapQRCode"></div>
                        <div class="zap-invoice" id="zapInvoice"></div>
                        <div class="zap-invoice-actions">
                            <button class="icon-btn" onclick="nym.copyZapInvoice()" style="flex: 1;">Copy
                                Invoice</button>
                            <button class="icon-btn" onclick="nym.openInWallet()" style="flex: 1;">Open Wallet</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="icon-btn" onclick="nym.closeZapModal()">Cancel</button>
                <button class="send-btn" id="zapSendBtn" onclick="nym.generateZapInvoice()">Generate Invoice</button>
            </div>
        </div>
    </div>

    <!-- Share Channel Modal -->
    <div class="modal" id="shareModal">
        <div class="modal-content share-modal">
            <div class="modal-header">Share Channel</div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Channel URL</label>
                    <div class="share-url-container">
                        <input type="text" class="share-url-input" id="shareUrlInput" readonly>
                        <button class="copy-url-btn" onclick="nym.copyShareUrl()">COPY</button>
                    </div>
                    <div class="form-hint">Share this URL to invite others to this channel</div>
                </div>
            </div>
            <div class="modal-actions">
                <button class="icon-btn" onclick="closeModal('shareModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Geohash Explorer Modal -->
    <div class="geohash-explorer-modal" id="geohashExplorerModal">
        <div class="geohash-explorer-content">
            <div class="geohash-explorer-header">
                <div class="geohash-explorer-title">Geohash Explorer</div>
                <button class="geohash-explorer-close" onclick="nym.closeGeohashExplorer()">Close</button>
            </div>
            <div class="geohash-explorer-body">
                <div class="geohash-globe-container" id="geohashGlobeCanvas">
                    <canvas class="geohash-globe-canvas" id="geohashGlobeCanvas"></canvas>

                    <div class="geohash-info-panel" id="geohashInfoPanel" style="display: none;">
                        <div class="geohash-info-title" id="geohashInfoTitle">Channel Info</div>
                        <div id="geohashInfoContent"></div>
                        <button class="geohash-join-btn" id="geohashJoinBtn">Join Channel</button>
                    </div>

                    <div class="geohash-controls">
                        <button class="geohash-control-btn" onclick="nym.resetGlobeView()">Reset View</button>
                    </div>

                    <div class="geohash-legend">
                        <div class="geohash-legend-item">
                            <div class="geohash-legend-dot"
                                style="background: var(--primary); box-shadow: 0 0 5px var(--primary);"></div>
                            <span>Active Channels</span>
                        </div>
                        <div class="geohash-legend-item">
                            <div class="geohash-legend-dot" style="background: var(--warning);"></div>
                            <span>Your Location</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Guided Tutorial Overlay -->
    <div id="tutorialOverlay" class="tutorial-overlay" aria-hidden="true">
        <div id="tutorialHighlight" class="tutorial-highlight" style="display:none;"></div>
        <div id="tutorialCard" class="tutorial-card" role="dialog" aria-modal="true" aria-labelledby="tutorialTitle">
            <div class="tutorial-header">
                <div class="tutorial-title" id="tutorialTitle">NYM Tutorial</div>
                <button id="tutorialSkipBtn" class="tutorial-skip" type="button">Skip</button>
            </div>
            <div class="tutorial-body" id="tutorialBody">
                Let's take a quick 60‚Äësecond tour so you know where everything lives.
            </div>
            <div class="tutorial-progress" id="tutorialProgress">Step 1 of 1</div>
            <div class="tutorial-actions">
                <button id="tutorialPrevBtn" class="tutorial-btn" type="button">Back</button>
                <button id="tutorialNextBtn" class="tutorial-btn" type="button">Next</button>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="nostr-tools.js"></script>
    <script src="app.js"></script>

    <!-- QRCode library for Lightning invoices -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <!-- Three.js and Globe libraries -->
    <script type="importmap">
    {
    "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js"
    }
    }
    </script>
    <script async type="module">
        import * as THREE from 'three';

        // Make available globally
        window.THREE = THREE;

        // Load three-globe after THREE is available
        const script = document.createElement('script');
        script.src = 'https://unpkg.com/three-globe@2.31.0/dist/three-globe.min.js';
        document.head.appendChild(script);
    </script>
</body>

</html>
